{"$schema": "https://raw.githubusercontent.com/oasis-tcs/sarif-spec/master/Schemata/sarif-schema-2.1.0.json", "version": "2.1.0", "runs": [{"tool": {"driver": {"name": "Checkov", "version": "3.2.340", "informationUri": "https://checkov.io", "rules": [{"id": "CKV_TF_1", "name": "Ensure Terraform module sources use a commit hash", "shortDescription": {"text": "Ensure Terraform module sources use a commit hash"}, "fullDescription": {"text": "Ensure Terraform module sources use a commit hash"}, "help": {"text": "Ensure Terraform module sources use a commit hash\nResource: module.eks.eks"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/supply-chain-policies/terraform-policies/ensure-terraform-module-sources-use-git-url-with-commit-hash-revision"}, {"id": "CKV_TF_2", "name": "Ensure Terraform module sources use a tag with a version number", "shortDescription": {"text": "Ensure Terraform module sources use a tag with a version number"}, "fullDescription": {"text": "Ensure Terraform module sources use a tag with a version number"}, "help": {"text": "Ensure Terraform module sources use a tag with a version number\nResource: module.vpc.vpc"}, "defaultConfiguration": {"level": "error"}, "helpUri": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/supply-chain-policies/terraform-policies/ensure-terraform-module-sources-use-tag"}], "organization": "bridgecrew"}}, "results": [{"ruleId": "CKV_TF_1", "ruleIndex": 0, "level": "error", "attachments": [], "message": {"text": "Ensure Terraform module sources use a commit hash"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/eks/main.tf"}, "region": {"startLine": 1, "endLine": 77, "snippet": {"text": "module \"eks\" {\n  source  = \"terraform-aws-modules/eks/aws\"\n  version = \"~> 20.31\"\n\n  cluster_name    = \"${var.cluster_name}-${var.env}-cluster\"\n  cluster_version = var.cluster_version\n\n  vpc_id                   = var.vpc_id\n  subnet_ids               = var.subnet_ids\n  control_plane_subnet_ids = var.control_plane_subnet_ids\n\n  # Security configurations\n  cluster_endpoint_public_access = true\n  cluster_endpoint_private_access = true\n  \n  cluster_encryption_config = {\n    provider_key_arn = var.kms_key_arn\n    resources        = [\"secrets\"]\n  }\n\n  cluster_addons = {\n    coredns = {\n      most_recent = true\n    }\n    eks-pod-identity-agent = {\n      most_recent = true\n    }\n    kube-proxy = {\n      most_recent = true\n    }\n    vpc-cni = {\n      most_recent = true\n    }\n    aws-ebs-csi-driver = {\n      most_recent = true\n    }\n  }\n\n  eks_managed_node_groups = {\n    primary_node_group = {\n      ami_type       = \"AL2023_x86_64_STANDARD\"\n      instance_types = var.eks_primary_instance_type\n\n      min_size     = var.node_group_min_size\n      max_size     = var.node_group_max_size\n      desired_size = var.node_group_desired_size\n\n      # Enable detailed monitoring\n      enable_monitoring = true\n\n      # Enable EBS optimization\n      ebs_optimized = true\n\n      # Block device mappings\n      block_device_mappings = {\n        xvda = {\n          device_name = \"/dev/xvda\"\n          ebs = {\n            volume_size           = 100\n            volume_type          = \"gp3\"\n            encrypted            = true\n            kms_key_id          = var.kms_key_arn\n            delete_on_termination = true\n          }\n        }\n      }\n    }\n  }\n\n  # Enable logging\n  cluster_enabled_log_types = [\"api\", \"audit\", \"authenticator\", \"controllerManager\", \"scheduler\"]\n\n  tags = {\n    Environment = var.env\n    Terraform   = \"true\"\n  }\n}\n"}}}}]}, {"ruleId": "CKV_TF_1", "ruleIndex": 0, "level": "error", "attachments": [], "message": {"text": "Ensure Terraform module sources use a commit hash"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/networking/main.tf"}, "region": {"startLine": 1, "endLine": 42, "snippet": {"text": "module \"vpc\" {\n  source = \"terraform-aws-modules/vpc/aws\"\n\n  name = \"${var.cluster_name}-${var.env}-vpc\"\n  cidr = \"192.168.0.0/16\"\n\n  azs             = data.aws_availability_zones.available.names\n  public_subnets  = [\"192.168.1.0/24\", \"192.168.2.0/24\", \"192.168.3.0/24\"]\n  private_subnets = [\"192.168.4.0/24\", \"192.168.5.0/24\", \"192.168.6.0/24\"]\n\n  enable_nat_gateway   = true\n  single_nat_gateway   = true\n  enable_dns_hostnames = true\n  enable_dns_support   = true\n\n  # Enable VPC flow logs\n  enable_flow_log                      = true\n  create_flow_log_cloudwatch_log_group = true\n  create_flow_log_cloudwatch_iam_role  = true\n  flow_log_max_aggregation_interval    = 60\n  \n  # Enable Network ACLs\n  manage_default_network_acl = true\n  default_network_acl_tags   = {\n    Name = \"${var.cluster_name}-${var.env}-default\"\n  }\n\n  tags = {\n    Terraform   = \"true\"\n    Environment = var.env\n  }\n\n  public_subnet_tags = {\n    \"kubernetes.io/role/elb\" = \"1\"\n    \"Environment\"            = var.env\n  }\n\n  private_subnet_tags = {\n    \"kubernetes.io/role/internal-elb\" = \"1\"\n    \"Environment\"                     = var.env\n  }\n}\n"}}}}]}, {"ruleId": "CKV_TF_2", "ruleIndex": 1, "level": "error", "attachments": [], "message": {"text": "Ensure Terraform module sources use a tag with a version number"}, "locations": [{"physicalLocation": {"artifactLocation": {"uri": "modules/networking/main.tf"}, "region": {"startLine": 1, "endLine": 42, "snippet": {"text": "module \"vpc\" {\n  source = \"terraform-aws-modules/vpc/aws\"\n\n  name = \"${var.cluster_name}-${var.env}-vpc\"\n  cidr = \"192.168.0.0/16\"\n\n  azs             = data.aws_availability_zones.available.names\n  public_subnets  = [\"192.168.1.0/24\", \"192.168.2.0/24\", \"192.168.3.0/24\"]\n  private_subnets = [\"192.168.4.0/24\", \"192.168.5.0/24\", \"192.168.6.0/24\"]\n\n  enable_nat_gateway   = true\n  single_nat_gateway   = true\n  enable_dns_hostnames = true\n  enable_dns_support   = true\n\n  # Enable VPC flow logs\n  enable_flow_log                      = true\n  create_flow_log_cloudwatch_log_group = true\n  create_flow_log_cloudwatch_iam_role  = true\n  flow_log_max_aggregation_interval    = 60\n  \n  # Enable Network ACLs\n  manage_default_network_acl = true\n  default_network_acl_tags   = {\n    Name = \"${var.cluster_name}-${var.env}-default\"\n  }\n\n  tags = {\n    Terraform   = \"true\"\n    Environment = var.env\n  }\n\n  public_subnet_tags = {\n    \"kubernetes.io/role/elb\" = \"1\"\n    \"Environment\"            = var.env\n  }\n\n  private_subnet_tags = {\n    \"kubernetes.io/role/internal-elb\" = \"1\"\n    \"Environment\"                     = var.env\n  }\n}\n"}}}}]}]}]}